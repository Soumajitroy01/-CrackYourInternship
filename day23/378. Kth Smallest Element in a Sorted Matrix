class Solution {
public:
    int kthSmallest(vector<vector<int>>& matrix, int k) {
        int r = matrix.size();
        int c = matrix[0].size();
        int lower = matrix[0][0];
        int upper = matrix[r-1][c-1];
        while(lower <= upper)
        {
            int mid = (lower+upper)/2;
            int ans =0;
            for(int i=0;i<r;i++)
            {
                int l=0;
                int h = c-1;
                while(l<=h)
                {
                    int m = (l+h)/2;
                    if(matrix[i][m]<=mid)
                        l=m+1;
                    else
                        h=m-1;
                }
                ans+=l;
            }
            if(ans < k) lower = mid+1;
            else upper = mid-1;
        }
        
        return lower;
    }
};

static bool     _foo = ios::sync_with_stdio(false);
static ostream* _bar = cin.tie(NULL);
