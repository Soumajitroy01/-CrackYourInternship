class Solution {
public:
    ListNode* addTwoNumbers(ListNode* l1, ListNode* l2) {
        if(l1==NULL && l2==NULL) return NULL;
        if(l1==NULL) return l2;
        if(l2==NULL) return l1;
        
        stack<int> s1,s2,s3;
        ListNode *tmp;
        tmp=l1;
        while(tmp)
        {
            s1.push(tmp->val);
            tmp=tmp->next;
        }
        tmp=l2;
        while(tmp)
        {
            s2.push(tmp->val);
            tmp=tmp->next;
        }
        
        int carry=0;
        while(!s1.empty() and !s2.empty())
        {
            int tp1,tp2;
            tp1=s1.top();
            tp2=s2.top();
            s1.pop();s2.pop();
            int sum=tp1+tp2+carry;
            if(sum>9)
            {
                sum=sum%10;
                carry=1;
            }
            else carry=0;
            s3.push(sum);
        }
        
        while(!s1.empty())
        {
            int tp1=s1.top();s1.pop();
            int sum = tp1+carry;
            if(sum>9)
            {
                sum=sum%10;
                carry=1;
            }
            else carry=0;
            s3.push(sum);
        }
        
        while(!s2.empty())
        {
            int tp2=s2.top();s2.pop();
            int sum=tp2+carry;
            if(sum>9)
            {
                sum=sum%10;
                carry=1;
            }
            else carry=0;
            
            s3.push(sum);
        }
        
        if(carry==1) s3.push(1);
        
        ListNode *ans;
        ans=new ListNode(s3.top());
        s3.pop();
        tmp=ans;
        while(!s3.empty())
        {
            tmp->next=new ListNode(s3.top());
            s3.pop();
            tmp=tmp->next;
        }
        
        return ans;
    }
};
