class Solution {
    int dp[102][102][102];
    int get(vector<int>& boxes, int left, int right, int streak)
    {
        if(left>right) return 0;
        if(left==right) return (streak+1)*(streak+1);
        if(dp[left][right][streak]!=0) return dp[left][right][streak];
        
        int maxi = get(boxes, left+1, right, 0) + (streak+1)*(streak+1);
        for(int i=left+1;i<=right;i++)
        {
            if(boxes[left]==boxes[i])
                maxi = max(maxi, get(boxes, left+1, i-1, 0) +
                          get(boxes, i, right, streak+1));
        }
        
        return dp[left][right][streak] = maxi;
    }
public:
    int removeBoxes(vector<int>& boxes) {
        if(boxes.size()==0) return 0;      
        return get(boxes, 0, boxes.size()-1, 0);
    }
};

static bool     _foo = ios::sync_with_stdio(false);
static ostream* _bar = cin.tie(NULL);
